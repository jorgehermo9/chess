{"ast":null,"code":"function createCell(i, j) {\n  return {\n    pos: {\n      i: i,\n      j: j\n    },\n    piece: null\n  };\n}\n\nexport function createBoard(n) {\n  const board = {\n    n: n,\n    cells: []\n  };\n\n  for (let i = 0; i < n; i++) {\n    for (let j = 0; j < n; j++) {\n      board.cells.push(createCell(i, j));\n    }\n  }\n\n  const settedBoard = setupBoard(board);\n  return settedBoard;\n}\n\nfunction setPiece(board, type, color, i, j) {\n  const cell = board.cells[j + i * board.n];\n  cell.piece = {\n    color: color,\n    type: type\n  };\n}\n\nfunction setupBoard(board) {\n  const newBoard = board;\n  setPiece(newBoard, \"R\", \"black\", 0, 0);\n  setPiece(newBoard, \"N\", \"black\", 0, 1);\n  setPiece(newBoard, \"B\", \"black\", 0, 2);\n  setPiece(newBoard, \"Q\", \"black\", 0, 3);\n  setPiece(newBoard, \"K\", \"black\", 0, 4);\n  setPiece(newBoard, \"B\", \"black\", 0, 5);\n  setPiece(newBoard, \"N\", \"black\", 0, 6);\n  setPiece(newBoard, \"R\", \"black\", 0, 7);\n  setPiece(newBoard, \"P\", \"black\", 1, 0);\n  setPiece(newBoard, \"P\", \"black\", 1, 1);\n  setPiece(newBoard, \"P\", \"black\", 1, 2);\n  setPiece(newBoard, \"P\", \"black\", 1, 3);\n  setPiece(newBoard, \"P\", \"black\", 1, 4);\n  setPiece(newBoard, \"P\", \"black\", 1, 5);\n  setPiece(newBoard, \"P\", \"black\", 1, 6);\n  setPiece(newBoard, \"P\", \"black\", 1, 7);\n  setPiece(newBoard, \"R\", \"white\", 7, 0);\n  setPiece(newBoard, \"N\", \"white\", 7, 1);\n  setPiece(newBoard, \"B\", \"white\", 7, 2);\n  setPiece(newBoard, \"Q\", \"white\", 7, 3);\n  setPiece(newBoard, \"K\", \"white\", 7, 4);\n  setPiece(newBoard, \"B\", \"white\", 7, 5);\n  setPiece(newBoard, \"N\", \"white\", 7, 6);\n  setPiece(newBoard, \"R\", \"white\", 7, 7);\n  setPiece(newBoard, \"P\", \"white\", 6, 0);\n  setPiece(newBoard, \"P\", \"white\", 6, 1);\n  setPiece(newBoard, \"P\", \"white\", 6, 2);\n  setPiece(newBoard, \"P\", \"white\", 6, 3);\n  setPiece(newBoard, \"P\", \"white\", 6, 4);\n  setPiece(newBoard, \"P\", \"white\", 6, 5);\n  setPiece(newBoard, \"P\", \"white\", 6, 6);\n  setPiece(newBoard, \"P\", \"white\", 6, 7);\n  return newBoard;\n}\n\nfunction isValidMove(board, move) {\n  return move.i >= 0 && move.i < board.n && move.j >= 0 && move.j < board.n;\n}\n\nfunction validMoves(board, color, moves) {\n  return moves.filter(move => {\n    const target = move.j + move.i * board.n;\n    return isValidMove(board, move) && (board.cells[target].piece === null || board.cells[target].piece.color !== color);\n  });\n}\n\nfunction pawnMoves(board, {\n  i,\n  j\n}, color) {\n  const facing = color === \"black\" ? 1 : -1;\n  const startVertical = color === \"black\" ? 1 : 6;\n  const moves = [];\n  const enemies = [{\n    i: i + facing,\n    j: j - 1\n  }, {\n    i: i + facing,\n    j: j + 1\n  }];\n  let move = {\n    i: i + facing,\n    j: j\n  };\n  let doublemove = {\n    i: i + 2 * facing,\n    j: j\n  };\n  enemies.forEach(enemy => {\n    if (isValidMove(board, enemy) && board.cells[enemy.j + enemy.i * board.n].piece && board.cells[enemy.j + enemy.i * board.n].piece.color !== color) {\n      moves.push(enemy);\n    }\n  });\n\n  if (isValidMove(board, move) && board.cells[move.j + move.i * board.n].piece === null) {\n    moves.push(move);\n\n    if (i === startVertical && isValidMove(board, doublemove) && board.cells[doublemove.j + doublemove.i * board.n].piece === null) {\n      moves.push(doublemove);\n    }\n  }\n\n  return validMoves(board, color, moves);\n}\n\nfunction knightMoves(board, {\n  i,\n  j\n}, color) {\n  const moves = [{\n    i: i + 2,\n    j: j - 1\n  }, {\n    i: i + 2,\n    j: j + 1\n  }, {\n    i: i - 2,\n    j: j - 1\n  }, {\n    i: i - 2,\n    j: j + 1\n  }, {\n    i: i + 1,\n    j: j - 2\n  }, {\n    i: i - 1,\n    j: j - 2\n  }, {\n    i: i + 1,\n    j: j + 2\n  }, {\n    i: i - 1,\n    j: j + 2\n  }];\n  return validMoves(board, color, moves);\n}\n\nfunction kingMoves(board, {\n  i,\n  j\n}, color) {\n  const moves = [{\n    i: i + 1,\n    j: j\n  }, {\n    i: i - 1,\n    j: j\n  }, {\n    i: i,\n    j: j + 1\n  }, {\n    i: i,\n    j: j - 1\n  }, {\n    i: i - 1,\n    j: j - 1\n  }, {\n    i: i - 1,\n    j: j + 1\n  }, {\n    i: i + 1,\n    j: j - 1\n  }, {\n    i: i + 1,\n    j: j + 1\n  }];\n  return validMoves(board, color, moves);\n}\n\nfunction expand(board, direction, starting) {\n  let moves = [];\n  let count = 1;\n  let cell = {\n    i: starting.i + direction.i,\n    j: starting.j + direction.j\n  };\n\n  while (isValidMove(board, cell) && board.cells[cell.j + cell.i * board.n].piece === null) {\n    moves.push(cell);\n    count++;\n    cell = {\n      i: starting.i + direction.i * count,\n      j: starting.j + direction.j * count\n    };\n  }\n\n  return moves;\n}\n\nfunction queenMoves(board, starting, color) {\n  let moves = [];\n  moves = [...moves, ...expand(board, {\n    i: 1,\n    j: 0\n  }, starting)];\n  moves = [...moves, ...expand(board, {\n    i: -1,\n    j: 0\n  }, starting)];\n  moves = [...moves, ...expand(board, {\n    i: 0,\n    j: 1\n  }, starting)];\n  moves = [...moves, ...expand(board, {\n    i: 0,\n    j: -1\n  }, starting)];\n  return moves;\n}\n\nexport function getMoves(board, {\n  pos,\n  piece\n}) {\n  let moves = [];\n\n  switch (piece.type) {\n    case \"P\":\n      moves = pawnMoves(board, pos, piece.color);\n      break;\n\n    case \"N\":\n      moves = knightMoves(board, pos, piece.color);\n      break;\n\n    case \"K\":\n      moves = kingMoves(board, pos, piece.color);\n      break;\n\n    case \"Q\":\n      moves = queenMoves(board, pos, piece.color);\n      break;\n\n    default:\n      break;\n  }\n\n  return moves;\n}","map":{"version":3,"sources":["/home/jorge/github/chess/src/components/Board/boardUtils.js"],"names":["createCell","i","j","pos","piece","createBoard","n","board","cells","push","settedBoard","setupBoard","setPiece","type","color","cell","newBoard","isValidMove","move","validMoves","moves","filter","target","pawnMoves","facing","startVertical","enemies","doublemove","forEach","enemy","knightMoves","kingMoves","expand","direction","starting","count","queenMoves","getMoves"],"mappings":"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","sourcesContent":["function createCell(i,j){\n\treturn {pos:{i:i,j:j}\n\t\t\t\t\t,piece: null };\n}\n\nexport function createBoard(n){\n\tconst board={n:n,cells:[]};\n\tfor(let i=0;i<n;i++){\n\t\tfor(let j =0;j<n;j++){\n\t\t\tboard.cells.push(createCell(i,j));\n\t\t}\n\t}\n\tconst settedBoard = setupBoard(board);\n\treturn settedBoard;\n}\nfunction setPiece(board,type,color,i,j){\n\tconst cell= board.cells[j + i*board.n];\n\tcell.piece = {color:color,type:type};\n}\nfunction setupBoard(board){\n\tconst newBoard = board;\n\tsetPiece(newBoard,\"R\",\"black\",0,0);\n\tsetPiece(newBoard,\"N\",\"black\",0,1);\n\tsetPiece(newBoard,\"B\",\"black\",0,2);\n\tsetPiece(newBoard,\"Q\",\"black\",0,3);\n\tsetPiece(newBoard,\"K\",\"black\",0,4);\n\tsetPiece(newBoard,\"B\",\"black\",0,5);\n\tsetPiece(newBoard,\"N\",\"black\",0,6);\n\tsetPiece(newBoard,\"R\",\"black\",0,7);\n\tsetPiece(newBoard,\"P\",\"black\",1,0);\n\tsetPiece(newBoard,\"P\",\"black\",1,1);\n\tsetPiece(newBoard,\"P\",\"black\",1,2);\n\tsetPiece(newBoard,\"P\",\"black\",1,3);\n\tsetPiece(newBoard,\"P\",\"black\",1,4);\n\tsetPiece(newBoard,\"P\",\"black\",1,5);\n\tsetPiece(newBoard,\"P\",\"black\",1,6);\n\tsetPiece(newBoard,\"P\",\"black\",1,7);\t\n\t\n\tsetPiece(newBoard,\"R\",\"white\",7,0);\n\tsetPiece(newBoard,\"N\",\"white\",7,1);\n\tsetPiece(newBoard,\"B\",\"white\",7,2);\n\tsetPiece(newBoard,\"Q\",\"white\",7,3);\n\tsetPiece(newBoard,\"K\",\"white\",7,4);\n\tsetPiece(newBoard,\"B\",\"white\",7,5);\n\tsetPiece(newBoard,\"N\",\"white\",7,6);\n\tsetPiece(newBoard,\"R\",\"white\",7,7);\n\tsetPiece(newBoard,\"P\",\"white\",6,0);\n\tsetPiece(newBoard,\"P\",\"white\",6,1);\n\tsetPiece(newBoard,\"P\",\"white\",6,2);\n\tsetPiece(newBoard,\"P\",\"white\",6,3);\n\tsetPiece(newBoard,\"P\",\"white\",6,4);\n\tsetPiece(newBoard,\"P\",\"white\",6,5);\n\tsetPiece(newBoard,\"P\",\"white\",6,6);\n\tsetPiece(newBoard,\"P\",\"white\",6,7);\n\n\treturn newBoard;\n}\n\nfunction isValidMove(board,move){\n\treturn move.i >=0 && move.i < board.n && move.j >=0 && move.j<board.n;\n}\nfunction validMoves(board,color,moves){\n\treturn moves.filter(move =>{\n\t\tconst target = move.j+move.i*board.n;\n\t\treturn (\n\t\t\tisValidMove(board,move) &&\n\t\t\t(board.cells[target].piece ===null || board.cells[target].piece.color !== color)\n\t\t);\n\t})\n}\nfunction pawnMoves(board,{i,j},color){\n\tconst facing = color === \"black\"?1:-1;\n\tconst startVertical = color===\"black\"?1:6;\n\tconst moves =[];\n\tconst enemies = [{i:i+facing,j:j-1},{i:i+facing,j:j+1}];\n\tlet move = {i:i+facing,j:j};\n\tlet doublemove = {i:i+2*facing,j:j};\n\n\tenemies.forEach( enemy => {\n\t\tif(isValidMove(board,enemy) && \n\t\t(board.cells[enemy.j + enemy.i*board.n].piece&&board.cells[enemy.j + enemy.i*board.n].piece.color!==color )){\n\t\t\tmoves.push(enemy);\n\t\t}\n\t})\n\n\tif(isValidMove(board,move)&&(board.cells[move.j + move.i*board.n].piece===null)){\n\t\t\tmoves.push(move);\n\t\t\tif(i ===startVertical && \n\t\t\t\tisValidMove(board,doublemove)&&(board.cells[doublemove.j + doublemove.i*board.n].piece===null)){\n\t\t\t\tmoves.push(doublemove);\n\t\t\t}\n\t\t}\n\treturn validMoves(board,color,moves);\n}\nfunction knightMoves(board,{i,j},color){\n\tconst moves =[\n\t\t{i:i+2,j:j-1},\n\t\t{i:i+2,j:j+1},\n\t\t{i:i-2,j:j-1},\n\t\t{i:i-2,j:j+1},\n\t\t{i:i+1,j:j-2},\n\t\t{i:i-1,j:j-2},\n\t\t{i:i+1,j:j+2},\n\t\t{i:i-1,j:j+2}\n\t];\n\treturn validMoves(board,color,moves);\n}\nfunction kingMoves(board,{i,j},color){\n\tconst moves = [\n\t\t{i:i+1,j:j},\n\t\t{i:i-1,j:j},\n\t\t{i:i,j:j+1},\n\t\t{i:i,j:j-1},\n\t\t{i:i-1,j:j-1},\n\t\t{i:i-1,j:j+1},\n\t\t{i:i+1,j:j-1},\n\t\t{i:i+1,j:j+1},\n\t];\n\treturn validMoves(board,color,moves);\n}\nfunction expand(board,direction,starting){\n\tlet moves=[];\n\tlet count =1;\n\tlet cell = {i:starting.i + direction.i,j:starting.j+direction.j};\n\twhile(isValidMove(board,cell) && board.cells[cell.j+cell.i*board.n].piece ===null){\n\t\tmoves.push(cell);\n\t\tcount++;\n\t\tcell = {i:starting.i+direction.i*count,j:starting.j+direction.j*count};\n\t}\n\treturn moves;\n}\nfunction queenMoves(board,starting,color){\n\tlet moves=[];\n\tmoves = [...moves,...expand(board,{i:1,j:0},starting)];\n\tmoves = [...moves,...expand(board,{i:-1,j:0},starting)];\n\tmoves = [...moves,...expand(board,{i:0,j:1},starting)];\n\tmoves = [...moves,...expand(board,{i:0,j:-1},starting)];\n\treturn moves;\n}\nexport function getMoves(board,{pos,piece}){\n\tlet moves= [];\n\tswitch (piece.type) {\n\t\tcase \"P\":\n\t\t\tmoves = pawnMoves(board,pos,piece.color);\n\t\t\tbreak;\n\t\tcase \"N\":\n\t\t\tmoves = knightMoves(board,pos,piece.color);\n\t\t\tbreak;\n\t\tcase \"K\":\n\t\t\tmoves = kingMoves(board,pos,piece.color);\n\t\t\tbreak;\n\t\tcase \"Q\":\n\t\t\tmoves = queenMoves(board,pos,piece.color);\n\t\t\tbreak;\n\t\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn moves;\n}\n\n\n"]},"metadata":{},"sourceType":"module"}